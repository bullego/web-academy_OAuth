(this.webpackJsonptrello=this.webpackJsonptrello||[]).push([[0],{24:function(e,t,n){e.exports=n(38)},30:function(e,t,n){},31:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var r,o=n(0),a=n.n(o),c=n(20),s=n(15),i=n.n(s),u=n(21),l=n(13),d=n(6),h=n(7),m=n(9),f=n(8),O=n(1),p=n(10),b=(n(30),Object({NODE_ENV:"production",PUBLIC_URL:"/web-academy_OAuth",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_API_KEY:"278f7af48162d7450bd84bc9d310e194",REACT_APP_NAME:"MyTrelloApp",REACT_APP_SCOPE:"read,write,account",REACT_APP_REDIRECT_URL:"https://bullego.github.io/web-academy_OAuth"})),E=b.REACT_APP_API_KEY,g=b.REACT_APP_NAME,A=b.REACT_APP_SCOPE,P=b.REACT_APP_REDIRECT_URL,T=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e="https://trello.com/1/authorize?return_url=".concat(P,"&expiration=1day&name=").concat(g,"&scope=").concat(A,"&response_type=token&key=").concat(E);return(o.createElement("div",{className:"Login"},o.createElement("a",{href:e},"Login with Trello account"),o.createElement("h2",null,"Please log in")))}}]),n}(o.Component),k=(n(31),function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).state={boards:[]},e}return Object(h.a)(n,[{key:"render",value:function(){return console.log("PROPS_in_DASH: ",this.props),o.createElement("div",{className:"Dashboard"},o.createElement("h2",null,"Hello from dashboard"),o.createElement("hr",null),o.createElement("ul",{className:"board-items"}))}}]),n}(o.Component)),_=function(e){return o.createElement("div",null,"404 not found")},v=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){console.log("APP_PROPS_FROM_HELLO: ",this.props);var e=this.props.setText;return(a.a.createElement("div",null,a.a.createElement("h1",null,"Hello World"),a.a.createElement("p",null,e)))}}]),n}(a.a.Component);!function(e){e.HOME="/",e.HELLO="/hello",e.LOGIN="/login",e.DASHBOARD="/dashboard",e.AUTHORIZATION="/authorization",e.NOT_FOUND="/404"}(r||(r={}));var y=[{path:r.LOGIN,exact:!0,title:"Go to Home/Login",render:function(e){return o.createElement(T,e)}},{path:r.DASHBOARD,exact:!1,title:"Go to Dashboard",isProtected:!0,render:function(e){return o.createElement(k,Object.assign({},e,{boards:"tesssst"}))}},{path:r.HOME,exact:!0,isHidden:!0,render:function(){return o.createElement(O.a,{to:r.LOGIN})}},{path:r.NOT_FOUND,isHidden:!0,render:function(e){return o.createElement(_,e)}},{path:r.HELLO,exact:!0,isHidden:!0,render:function(e){return o.createElement(v,e)}}],R=function(e,t){window.localStorage.setItem(e,JSON.stringify(t))},S=function(e){console.log("PROPS from AUTH: ",e);var t=e.location.hash;return(0,e.onSetToken)(t.split("=")[1]),a.a.createElement(O.a,{to:r.DASHBOARD})},j=n(23),N=function(e){var t=e.render,n=e.isAuthenticated,r=Object(j.a)(e,["render","isAuthenticated"]);return console.log("PROTECTED rest PROPS: ",Object(l.a)({},r)),a.a.createElement(O.b,Object.assign({},r,{render:function(e){return n?t(e):a.a.createElement(O.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},H=(n(37),{token:"",boards:[],userProfile:void 0,userName:"bullego1",someText:"test_test_test"}),C=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state=H,e.setProfile=function(t){e.setState({userProfile:t})},e.setToken=function(t){e.setState({token:t}),R("TOKEN",{token:t,someValue:10})},e.setBoards=function(t){e.setState({boards:t})},e.logOut=function(){e.setState(H),e.goToLogin()},e.renderRoute=function(t,n){return t.isProtected?o.createElement(N,{key:n,path:t.path,exact:t.exact,render:t.render,isAuthenticated:e.isLoggedIn,boards:e.state.boards}):o.createElement(O.b,{key:n,path:t.path,exact:t.exact,render:function(e){return t.render(Object(l.a)({},e))}})},e.someFunc=function(){return e.state.someText},e}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.getToken()}},{key:"getToken",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t,n,r,o,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.token){e.next=2;break}return e.abrupt("return");case 2:if(c="TOKEN",t=JSON.parse(window.localStorage.getItem(c)||"{}"),n=t.token){e.next=5;break}return e.abrupt("return",this.goToLogin());case 5:return r="https://api.trello.com/1/members/me?key=".concat("278f7af48162d7450bd84bc9d310e194","&token=").concat(n),e.next=8,fetch(r);case 8:if(!0!==(o=e.sent).ok||200!==o.status){e.next=16;break}return e.next=12,o.json();case 12:return a=e.sent,this.setProfile(a),this.setToken(n),e.abrupt("return",this.goToDashboard());case 16:return e.abrupt("return",this.goToLogin());case 17:case"end":return e.stop()}var c}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"goToLogin",value:function(){this.props.history.push(r.LOGIN)}},{key:"goToDashboard",value:function(){var e=this,t=this.state.token,n=this.state.userName,o="https://api.trello.com/1/members/".concat(n,"/boards?key=").concat("278f7af48162d7450bd84bc9d310e194","&token=").concat(t);console.log("token FROM APP: ",t),console.log("userName FROM APP: ",n),console.log("url FROM APP: ",o),fetch(o).then((function(e){if(200!==e.status)throw Error("not success");return e.json()})).then((function(t){console.log("Boards: ",t),e.setBoards(t)})).catch((function(e){console.log(e)})),this.props.history.push(r.DASHBOARD)}},{key:"renderHeader",value:function(){return o.createElement("header",{className:"header"},y.map((function(e,t){return e.isHidden?null:o.createElement(p.b,{key:t,to:e.path},e.title)})),o.createElement("button",{onClick:this.logOut},"Log Out"))}},{key:"renderContent",value:function(){var e=this;return(o.createElement("main",{className:"main"},o.createElement(O.d,null,y.map(this.renderRoute),o.createElement(O.b,{path:r.AUTHORIZATION,render:function(t){return o.createElement(S,Object.assign({},t,{onSetToken:e.setToken}))}}),o.createElement(O.a,{to:r.NOT_FOUND})),o.createElement(O.b,{path:r.HOME,render:function(t){return o.createElement(v,Object.assign({},t,{setText:e.someFunc(),boards:e.state.boards}))}})))}},{key:"render",value:function(){return o.createElement("div",null,this.renderHeader(),this.renderContent())}},{key:"isLoggedIn",get:function(){return!!this.state.token}}]),n}(o.Component),D=Object(O.g)(C),L=o.createElement(p.a,null,o.createElement(D,null));c.render(L,document.querySelector("#root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.911c6727.chunk.js.map